{% comment %}
  GK Tour Dates — unified section (ONE instance, shared block data)
  ─────────────────────────────────────────────────────────────────
  This section lives in layout/theme.liquid as a STATIC section so
  the same instance (same blocks / same dates) renders on both:
    • template = index        → home variant  (gk-date-row classes)
    • template = page/dates   → page variant  (gk-date classes)

  All block editing happens in ONE place in the Theme Editor.
  The section detects the current template and adapts:
    - visible rows before "show more"
    - CSS class namespace (gk-date-row vs gk-date)
    - CTA / reveal behaviour

  Block type: show
    show_date   — parseable date string, e.g. "April 22, 2026"
    venue_name  — venue name
    city_state  — "City, ST"
    descriptor  — optional sub-line, e.g. "support for Paul Gilbert"
    ticket_url  — leave blank → TBA
    is_sold_out — check for SOLD OUT

  Date logic:
    • Blocks are sorted ascending by show_date
    • Past dates are filtered out automatically
    • Unparseable dates are kept visible (safe fallback)
{% endcomment %}

{%- liquid
  assign today_ymd = 'now' | date: '%Y-%m-%d'
  assign today_ts  = today_ymd | date: '%s' | plus: 0

  comment
    Detect which visual variant to use based on current template.
    index template          → home variant (gk-date-row)
    page.dates template     → page variant (gk-date)
  endcomment

  if template.name == 'index'
    assign is_home    = true
    assign row_prefix = 'gk-date-row'
    assign apply_hidden = false
    assign initial_visible = section.settings.home_visible_count | default: 3
    assign reveal_step     = section.settings.home_reveal_step    | default: 3
  else
    assign is_home    = false
    assign row_prefix = 'gk-date'
    assign apply_hidden = true
    assign initial_visible = section.settings.page_visible_count | default: 10
    assign reveal_step     = section.settings.page_reveal_step   | default: 10
  endif
-%}

{%- comment -%}
  ── STEP 1: Build a sortable key list of UPCOMING block indices ──
  Sort key = "YYYYMMDD_blockIndex"  →  lexicographic sort is date-correct.
  Unparseable dates get key "99999999_..." so they sort to the end
  and stay visible (safe fallback).
{%- endcomment -%}
{%- assign _pairs = '' -%}
{%- for block in section.blocks -%}
  {%- if block.type == 'show' -%}
    {%- assign _raw    = block.settings.show_date | default: '' | strip -%}
    {%- assign _show_ts = _raw | date: '%s' | plus: 0 -%}
    {%- assign _keep   = false -%}
    {%- if _raw != blank -%}
      {%- if _show_ts == 0 -%}
        {%- assign _keep = true -%}
      {%- elsif _show_ts >= today_ts -%}
        {%- assign _keep = true -%}
      {%- endif -%}
    {%- endif -%}
    {%- if _keep -%}
      {%- assign _sort_key = _raw | date: '%Y%m%d' -%}
      {%- if _sort_key == blank -%}{%- assign _sort_key = '99999999' -%}{%- endif -%}
      {%- assign _pairs = _pairs | append: _sort_key | append: '_' | append: forloop.index0 | append: '|' -%}
    {%- endif -%}
  {%- endif -%}
{%- endfor -%}

{%- assign _sorted_pairs = _pairs | split: '|' | sort -%}

{%- comment -%} Count upcoming dates for show-more logic {%- endcomment -%}
{%- assign upcoming_count = 0 -%}
{%- for _p in _sorted_pairs -%}
  {%- if _p != blank -%}{%- assign upcoming_count = upcoming_count | plus: 1 -%}{%- endif -%}
{%- endfor -%}

{%- comment -%}── FALLBACK: no blocks yet → count from snippet (settings textarea / hardcoded list) ──{%- endcomment -%}
{%- if section.blocks.size == 0 -%}
  {%- capture _fc -%}{%- render 'gk-tour-dates-shared', mode: 'count' -%}{%- endcapture -%}
  {%- assign upcoming_count = _fc | strip | plus: 0 -%}
{%- endif -%}

{%- comment -%} Shared section wrapper class {%- endcomment -%}
{%- if is_home -%}
  {%- assign wrapper_class = 'gk-tour-dates gk-tour-dates--reveal' -%}
  {%- assign inner_class   = 'gk-tour-dates__inner' -%}
  {%- assign eyebrow_class = 'gk-tour-dates__eyebrow' -%}
  {%- assign heading_class = 'gk-tour-dates__heading' -%}
  {%- assign subtext_class = 'gk-tour-dates__subtext' -%}
  {%- assign list_class    = 'gk-tour-dates__list' -%}
  {%- assign empty_class   = 'gk-tour-dates__empty' -%}
{%- else -%}
  {%- assign wrapper_class = 'gk-dates' -%}
  {%- assign inner_class   = 'gk-dates__inner' -%}
  {%- assign eyebrow_class = 'gk-dates__eyebrow' -%}
  {%- assign heading_class = 'gk-dates__heading' -%}
  {%- assign subtext_class = 'gk-dates__subtext' -%}
  {%- assign list_class    = 'gk-dates__list' -%}
  {%- assign empty_class   = 'gk-dates__empty' -%}
{%- endif -%}

<section class="{{ wrapper_class }}" data-section-id="{{ section.id }}">
  <div class="{{ inner_class }}">

    {%- if section.settings.eyebrow != blank -%}
      <div class="{{ eyebrow_class }}">{{ section.settings.eyebrow }}</div>
    {%- endif -%}

    {%- if section.settings.heading != blank -%}
      <h2 class="{{ heading_class }}">{{ section.settings.heading }}</h2>
    {%- endif -%}

    {%- if section.settings.subtext != blank -%}
      <div class="{{ subtext_class }}">{{ section.settings.subtext }}</div>
    {%- endif -%}

    <div
      class="{{ list_class }}"
      role="list"
      {%- unless is_home %}
        data-visible-count="{{ initial_visible }}"
        data-reveal-step="{{ reveal_step }}"
      {%- endunless %}
    >
      {%- if section.blocks.size == 0 -%}
        {%- comment -%}── FALLBACK: render from snippet until blocks are populated ──{%- endcomment -%}
        {%- if is_home -%}
          {%- render 'gk-tour-dates-shared', mode: 'render_home' -%}
        {%- else -%}
          {%- render 'gk-tour-dates-shared', mode: 'render', row_prefix: 'gk-date', visible_count: initial_visible, use_hidden_class: true -%}
        {%- endif -%}
      {%- else -%}
        {%- assign render_idx = 0 -%}
        {%- for _pair in _sorted_pairs -%}
          {%- if _pair != blank -%}
            {%- assign _block_idx = _pair | split: '_' | last | plus: 0 -%}
            {%- assign _b = section.blocks[_block_idx] -%}

            {%- assign show_date   = _b.settings.show_date   | default: '' | strip -%}
            {%- assign venue_name  = _b.settings.venue_name  | default: '' | strip -%}
            {%- assign city_state  = _b.settings.city_state  | default: '' | strip -%}
            {%- assign descriptor  = _b.settings.descriptor  | default: '' | strip -%}
            {%- assign ticket_url  = _b.settings.ticket_url  | default: '' | strip -%}
            {%- assign is_sold_out = _b.settings.is_sold_out -%}

            {%- assign extra_class = '' -%}
            {%- if apply_hidden and render_idx >= initial_visible -%}
              {%- assign extra_class = ' is-hidden' -%}
            {%- endif -%}

            <div
              class="{{ row_prefix }}{{ extra_class }}"
              role="listitem"
              data-date-row
              data-index="{{ render_idx }}"
              {{ _b.shopify_attributes }}
            >
              <div class="{{ row_prefix }}__date">{{ show_date }}</div>

              <div class="{{ row_prefix }}__details">
                {%- if venue_name != blank -%}
                  <div class="{{ row_prefix }}__venue">{{ venue_name }}</div>
                {%- endif -%}
                {%- if descriptor != blank -%}
                  <div class="{{ row_prefix }}__descriptor">{{ descriptor }}</div>
                {%- endif -%}
                {%- if city_state != blank -%}
                  <div class="{{ row_prefix }}__city">{{ city_state }}</div>
                {%- endif -%}
              </div>

              <div class="{{ row_prefix }}__cta">
                {%- if is_sold_out -%}
                  {%- if is_home -%}
                    <span class="{{ row_prefix }}__soldout" aria-label="Sold out">SOLD OUT</span>
                  {%- else -%}
                    <span class="gk-date__pill gk-date__pill--muted" aria-label="Sold out">SOLD OUT</span>
                  {%- endif -%}
                {%- elsif ticket_url != blank -%}
                  {%- if is_home -%}
                    <a class="{{ row_prefix }}__btn" href="{{ ticket_url }}" target="_blank" rel="noopener">GET TICKETS</a>
                  {%- else -%}
                    <a class="gk-date__pill gk-date__pill--accent" href="{{ ticket_url }}" target="_blank" rel="noopener">GET TICKETS</a>
                  {%- endif -%}
                {%- else -%}
                  {%- if is_home -%}
                    <span class="{{ row_prefix }}__soldout" aria-label="Tickets TBA">TBA</span>
                  {%- else -%}
                    <span class="gk-date__pill gk-date__pill--muted" aria-label="Tickets TBA">TBA</span>
                  {%- endif -%}
                {%- endif -%}
              </div>
            </div>

            {%- assign render_idx = render_idx | plus: 1 -%}
          {%- endif -%}
        {%- endfor -%}
      {%- endif -%}
    </div>

    {%- if upcoming_count == 0 -%}
      <div class="{{ empty_class }}">{{ section.settings.empty_text }}</div>
    {%- endif -%}

    {%- comment -%} ── Controls ── {%- endcomment -%}
    {%- if is_home -%}
      {%- if upcoming_count > initial_visible -%}
        <div class="gk-tour-dates__more-wrap">
          <button type="button" class="gk-tour-dates__more">
            {{ section.settings.home_more_label }}
          </button>
        </div>
      {%- endif -%}
    {%- else -%}
      {%- if upcoming_count > initial_visible -%}
        <div class="gk-dates__controls">
          <button class="gk-dates__btn" type="button" data-dates-more>
            {{ section.settings.page_more_label }}
          </button>
          <button class="gk-dates__btn gk-dates__btn--ghost" type="button" data-dates-less hidden>
            {{ section.settings.page_less_label }}
          </button>
          {%- if section.settings.view_all_url != blank -%}
            <a class="gk-dates__btn gk-dates__btn--ghost" href="{{ section.settings.view_all_url }}">
              {{ section.settings.view_all_label }}
            </a>
          {%- endif -%}
        </div>
      {%- elsif section.settings.view_all_url != blank -%}
        <div class="gk-dates__controls">
          <a class="gk-dates__btn gk-dates__btn--ghost" href="{{ section.settings.view_all_url }}">
            {{ section.settings.view_all_label }}
          </a>
        </div>
      {%- endif -%}
    {%- endif -%}

  </div>
</section>

{%- comment -%} ── JavaScript ── {%- endcomment -%}
{%- if is_home and upcoming_count > initial_visible -%}
<script>
(function () {
  var section = document.querySelector('[data-section-id="{{ section.id }}"]');
  if (!section) return;
  var rows = section.querySelectorAll('.gk-date-row');
  var btn  = section.querySelector('.gk-tour-dates__more');
  if (!btn || !rows.length) return;

  var initial = {{ initial_visible }};
  var step    = {{ reveal_step }};
  var shown   = Math.min(initial, rows.length);

  function render() {
    rows.forEach(function (row, idx) {
      row.style.display = (idx < shown) ? '' : 'none';
    });
    btn.style.display = (shown >= rows.length) ? 'none' : '';
  }
  render();
  btn.addEventListener('click', function () {
    shown = Math.min(shown + step, rows.length);
    render();
  });
})();
</script>
{%- elsif is_home == false and upcoming_count > initial_visible -%}
<script>
(function() {
  var root = document.querySelector('.gk-dates[data-section-id="{{ section.id }}"]');
  if (!root) return;
  var list = root.querySelector('.gk-dates__list');
  if (!list) return;
  var rows = Array.prototype.slice.call(root.querySelectorAll('[data-date-row]'));
  if (!rows.length) return;
  var moreBtn = root.querySelector('[data-dates-more]');
  var lessBtn = root.querySelector('[data-dates-less]');
  var visibleCount = parseInt(list.getAttribute('data-visible-count') || '10', 10);
  var step = parseInt(list.getAttribute('data-reveal-step') || '10', 10);
  var shown = Math.min(visibleCount, rows.length);

  function apply() {
    rows.forEach(function(r, i) {
      if (i < shown) r.classList.remove('is-hidden');
      else r.classList.add('is-hidden');
    });
    if (moreBtn) moreBtn.hidden = (shown >= rows.length);
    if (lessBtn) lessBtn.hidden = (shown <= visibleCount);
  }
  if (moreBtn) {
    moreBtn.addEventListener('click', function() {
      shown = Math.min(shown + step, rows.length);
      apply();
    });
  }
  if (lessBtn) {
    lessBtn.addEventListener('click', function() {
      shown = Math.min(visibleCount, rows.length);
      apply();
      root.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
  }
  apply();
})();
</script>
{%- endif -%}

{% style %}
/* ─── HOME VARIANT: .gk-tour-dates + .gk-date-row ─────────────────── */
.gk-tour-dates {
  --bg:     {{ section.settings.bg_color }};
  --text:   #FFFFFF;
  --line:   rgba(255,255,255,0.12);
  --muted:  rgba(255,255,255,0.72);
  --accent: {{ section.settings.accent_color }};

  background: var(--bg);
  color: var(--text);
  padding: {{ section.settings.padding_top }}px 20px {{ section.settings.padding_bottom }}px;
}

.gk-tour-dates__inner {
  max-width: 1100px;
  margin: 0 auto;
}

.gk-tour-dates__eyebrow {
  font-family: "DM Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  text-transform: uppercase;
  letter-spacing: 0.16em;
  font-size: 12px;
  color: rgba(255,255,255,0.62);
  margin-bottom: 10px;
  text-align: {{ section.settings.text_align }};
}

.gk-tour-dates__heading {
  margin: 0 0 8px 0;
  font-family: "Bebas Neue", sans-serif;
  font-weight: 400;
  letter-spacing: 0.03em;
  line-height: 1;
  font-size: clamp(44px, 6vw, 76px);
  text-align: {{ section.settings.text_align }};
}

.gk-tour-dates__subtext {
  font-family: "DM Sans", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  font-size: 16px;
  color: var(--muted);
  margin-bottom: 22px;
  text-align: {{ section.settings.text_align }};
  max-width: 70ch;
}

.gk-tour-dates__list {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.gk-date-row {
  display: grid;
  grid-template-columns: minmax(160px, 220px) 1fr auto;
  gap: 16px;
  align-items: center;
  padding: 14px 16px;
  border: 1px solid var(--line);
  border-radius: 14px;
  background: rgba(0,0,0,0.22);
  box-shadow: 0 18px 40px rgba(0,0,0,0.28);
  transition: transform 160ms ease, border-color 160ms ease, background 160ms ease;
}

.gk-date-row:hover {
  transform: translateY(-1px);
  border-color: rgba(232,105,10,0.35);
  background: linear-gradient(180deg, rgba(232,105,10,0.14), rgba(0,0,0,0.18));
}

.gk-date-row__date {
  font-family: "Bebas Neue", sans-serif;
  font-weight: 400;
  letter-spacing: 0.02em;
  color: var(--accent);
  font-size: 28px;
  line-height: 1;
}

.gk-date-row__details {
  display: flex;
  flex-direction: column;
  gap: 4px;
  min-width: 0;
}

.gk-date-row__venue {
  font-family: "DM Sans", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  font-size: 18px;
  line-height: 1.2;
  color: #FFFFFF;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.gk-date-row__descriptor {
  font-family: "DM Sans", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  font-size: 12px;
  font-style: italic;
  color: rgba(255,255,255,0.50);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.gk-date-row__city {
  font-family: "DM Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 12px;
  letter-spacing: 0.10em;
  text-transform: uppercase;
  color: rgba(255,255,255,0.72);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.gk-date-row__cta {
  display: flex;
  justify-content: flex-end;
}

.gk-date-row__btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 10px 14px;
  border-radius: 999px;
  background: var(--accent);
  color: #0D0D0D;
  text-decoration: none;
  font-family: "DM Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 12px;
  letter-spacing: 0.10em;
  text-transform: uppercase;
  border: 1px solid var(--accent);
  transition: transform 140ms ease, opacity 140ms ease;
}

.gk-date-row__btn:hover  { opacity: 0.92; transform: translateY(-1px); }
.gk-date-row__btn:active { transform: translateY(0); }

.gk-date-row__soldout {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 10px 14px;
  border-radius: 999px;
  font-family: "DM Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 12px;
  letter-spacing: 0.10em;
  text-transform: uppercase;
  color: rgba(255,255,255,0.55);
  border: 1px solid rgba(255,255,255,0.18);
  background: rgba(0,0,0,0.18);
}

.gk-tour-dates__more-wrap {
  margin-top: 16px;
  display: flex;
  justify-content: {{ section.settings.text_align }};
}

.gk-tour-dates__more {
  appearance: none;
  border: 1px solid rgba(255,255,255,0.16);
  background: rgba(0,0,0,0.22);
  color: rgba(255,255,255,0.88);
  border-radius: 999px;
  padding: 12px 16px;
  font-family: "DM Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 12px;
  letter-spacing: 0.10em;
  text-transform: uppercase;
  cursor: pointer;
  transition: transform 160ms ease, border-color 160ms ease, background 160ms ease;
}

.gk-tour-dates__more:hover {
  transform: translateY(-1px);
  border-color: rgba(232,105,10,0.30);
  background: rgba(0,0,0,0.34);
}

.gk-tour-dates__empty {
  margin-top: 18px;
  padding: 16px 0;
  border-top: 1px solid var(--line);
  font-family: "DM Sans", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  font-size: 16px;
  color: var(--muted);
}

@media (max-width: 720px) {
  .gk-date-row {
    grid-template-columns: 1fr;
    gap: 10px;
  }
  .gk-date-row__cta  { justify-content: flex-start; }
  .gk-date-row__date { font-size: 30px; }
}

/* ─── PAGE VARIANT: .gk-dates + .gk-date ──────────────────────────── */
.gk-dates {
  --bg:              {{ section.settings.bg_color }};
  --text:            #fff;
  --muted:           rgba(255,255,255,0.72);
  --line:            rgba(255,255,255,0.10);
  --ring:            rgba(255,255,255,0.12);
  --accent:          {{ section.settings.accent_color }};
  --accentGlow:      rgba(232,105,10,0.22);
  --accentGlowStrong:rgba(232,105,10,0.35);

  background: var(--bg);
  color: var(--text);
  padding: {{ section.settings.padding_top }}px 20px {{ section.settings.padding_bottom }}px;
}

.gk-dates__inner { max-width: 1100px; margin: 0 auto; }

.gk-dates__eyebrow {
  font-family: "DM Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  text-transform: uppercase;
  letter-spacing: 0.16em;
  font-size: 12px;
  color: rgba(255,255,255,0.62);
  margin-bottom: 10px;
  text-align: {{ section.settings.text_align }};
}

.gk-dates__heading {
  margin: 0;
  font-family: "Bebas Neue", sans-serif;
  font-weight: 400;
  letter-spacing: 0.03em;
  line-height: 1;
  font-size: clamp(44px, 6vw, 76px);
  text-align: {{ section.settings.text_align }};
}

.gk-dates__subtext {
  margin-top: 10px;
  font-family: "DM Sans", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  color: var(--muted);
  font-size: 16px;
  line-height: 1.4;
  max-width: 60ch;
  text-align: {{ section.settings.text_align }};
}

.gk-dates__list {
  margin-top: 26px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.gk-date {
  position: relative;
  display: grid;
  grid-template-columns: minmax(170px, 240px) 1fr auto;
  gap: 16px;
  align-items: center;
  padding: 18px 18px;
  border-radius: 18px;
  border: 1px solid var(--ring);
  background:
    radial-gradient(1200px 200px at 20% 0%, rgba(255,255,255,0.06), transparent 50%),
    linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
  box-shadow: 0 18px 42px rgba(0,0,0,0.32);
  transition: transform 160ms ease, border-color 160ms ease, box-shadow 160ms ease;
}

.gk-date::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 18px;
  pointer-events: none;
  opacity: 0;
  transition: opacity 160ms ease;
  background:
    radial-gradient(800px 160px at 20% 50%, var(--accentGlowStrong), transparent 65%),
    linear-gradient(90deg, rgba(232,105,10,0.10), rgba(232,105,10,0.00) 55%);
}

.gk-date:hover {
  transform: translateY(-1px);
  border-color: rgba(232,105,10,0.45);
  box-shadow:
    0 22px 58px rgba(0,0,0,0.40),
    0 0 0 1px rgba(232,105,10,0.18) inset;
}

.gk-date:hover::before { opacity: 1; }
.gk-date.is-hidden     { display: none; }

.gk-date__date {
  font-family: "Bebas Neue", sans-serif;
  font-weight: 400;
  letter-spacing: 0.02em;
  color: var(--accent);
  font-size: 34px;
  line-height: 1;
  white-space: nowrap;
}

.gk-date__details { min-width: 0; display: flex; flex-direction: column; gap: 4px; }

.gk-date__venue {
  font-family: "DM Sans", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  font-size: 20px;
  line-height: 1.2;
  color: #fff;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.gk-date__descriptor {
  font-family: "DM Sans", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  font-size: 13px;
  font-style: italic;
  color: rgba(255,255,255,0.50);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.gk-date__city {
  font-family: "DM Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 13px;
  letter-spacing: 0.10em;
  text-transform: uppercase;
  color: rgba(255,255,255,0.70);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.gk-date__cta { display: flex; justify-content: flex-end; }

.gk-date__pill {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-height: 44px;
  padding: 10px 18px;
  border-radius: 999px;
  font-family: "DM Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 12px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  text-decoration: none;
  border: 1px solid rgba(255,255,255,0.16);
  background: rgba(0,0,0,0.20);
  color: rgba(255,255,255,0.86);
  transition: transform 140ms ease, border-color 140ms ease, background 140ms ease, box-shadow 140ms ease;
}

.gk-date__pill--accent {
  background: rgba(232,105,10,0.90);
  border-color: rgba(232,105,10,0.90);
  color: #0D0D0D;
}

.gk-date__pill--muted { }

.gk-date__pill:hover {
  transform: translateY(-1px);
  border-color: rgba(255,255,255,0.26);
  background: rgba(0,0,0,0.28);
}

.gk-date__pill--accent:hover {
  background: rgba(232,105,10,0.98);
  border-color: rgba(232,105,10,0.98);
  box-shadow: 0 10px 26px rgba(232,105,10,0.28);
}

.gk-date__pill:focus-visible,
.gk-dates__btn:focus-visible {
  outline: 2px solid rgba(232,105,10,0.75);
  outline-offset: 3px;
}

.gk-dates__empty {
  margin-top: 18px;
  padding: 16px 0;
  border-top: 1px solid var(--line);
  font-family: "DM Sans", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  font-size: 16px;
  color: var(--muted);
}

.gk-dates__controls {
  margin-top: 18px;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}

.gk-dates__btn {
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-height: 44px;
  padding: 10px 16px;
  border-radius: 999px;
  font-family: "DM Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 12px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  border: 1px solid rgba(255,255,255,0.16);
  background: rgba(232,105,10,0.90);
  color: #0D0D0D;
  text-decoration: none;
  transition: transform 140ms ease, opacity 140ms ease, border-color 140ms ease, background 140ms ease, box-shadow 140ms ease;
}

.gk-dates__btn:hover  { transform: translateY(-1px); opacity: 0.96; box-shadow: 0 10px 26px rgba(232,105,10,0.20); }
.gk-dates__btn:active { transform: translateY(0); }

.gk-dates__btn--ghost {
  background: rgba(0,0,0,0.22);
  color: rgba(255,255,255,0.86);
  border-color: rgba(255,255,255,0.16);
  box-shadow: none;
}

.gk-dates__btn--ghost:hover {
  background: rgba(0,0,0,0.30);
  border-color: rgba(255,255,255,0.26);
  box-shadow: none;
}

@media (max-width: 820px) {
  .gk-date {
    grid-template-columns: 1fr;
    gap: 10px;
    padding: 16px;
  }
  .gk-date__cta  { justify-content: flex-start; }
  .gk-date__date { font-size: 32px; }
}
{% endstyle %}

{% schema %}
{
  "name": "GK Tour Dates",
  "blocks": [
    {
      "type": "show",
      "name": "Show",
      "settings": [
        {
          "type": "text",
          "id": "show_date",
          "label": "Date",
          "info": "e.g. April 22, 2026 — use a standard date format so past dates are filtered automatically"
        },
        {
          "type": "text",
          "id": "venue_name",
          "label": "Venue"
        },
        {
          "type": "text",
          "id": "city_state",
          "label": "City, State",
          "info": "e.g. Omaha, NE"
        },
        {
          "type": "text",
          "id": "descriptor",
          "label": "Descriptor (optional)",
          "info": "e.g. support for Paul Gilbert — renders in italic under the venue name"
        },
        {
          "type": "url",
          "id": "ticket_url",
          "label": "Ticket URL",
          "info": "Leave blank to show TBA"
        },
        {
          "type": "checkbox",
          "id": "is_sold_out",
          "label": "Sold out",
          "default": false
        }
      ]
    }
  ],
  "settings": [
    {
      "type": "header",
      "content": "Header text"
    },
    { "type": "text",  "id": "eyebrow",    "label": "Eyebrow",          "default": "Tour Dates" },
    { "type": "text",  "id": "heading",    "label": "Heading",          "default": "GREG KOCH DATES" },
    { "type": "text",  "id": "subtext",    "label": "Subtext",          "default": "See upcoming dates below." },
    { "type": "text",  "id": "empty_text", "label": "Empty state text", "default": "No upcoming dates. Check back soon." },
    {
      "type": "select",
      "id": "text_align",
      "label": "Text alignment",
      "default": "left",
      "options": [
        { "value": "left",   "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right",  "label": "Right" }
      ]
    },
    {
      "type": "header",
      "content": "Homepage settings"
    },
    { "type": "range", "id": "home_visible_count", "label": "Initially visible (homepage)", "min": 1, "max": 20, "step": 1, "default": 3 },
    { "type": "range", "id": "home_reveal_step",   "label": "Reveal step (homepage)",       "min": 1, "max": 20, "step": 1, "default": 3 },
    { "type": "text",  "id": "home_more_label",    "label": "Show more button label",        "default": "Show more dates" },
    {
      "type": "header",
      "content": "Dates page settings"
    },
    { "type": "range", "id": "page_visible_count", "label": "Initially visible (dates page)", "min": 1, "max": 30, "step": 1, "default": 10 },
    { "type": "range", "id": "page_reveal_step",   "label": "Reveal step (dates page)",       "min": 1, "max": 30, "step": 1, "default": 10 },
    { "type": "text",  "id": "page_more_label",    "label": "Show more label",                "default": "Show more dates" },
    { "type": "text",  "id": "page_less_label",    "label": "Show fewer label",               "default": "Show fewer dates" },
    { "type": "text",  "id": "view_all_label",     "label": "View all label",                 "default": "View all dates" },
    { "type": "url",   "id": "view_all_url",       "label": "View all URL" },
    {
      "type": "header",
      "content": "Style"
    },
    { "type": "color", "id": "bg_color",     "label": "Background color", "default": "#0D0D0D" },
    { "type": "color", "id": "accent_color", "label": "Accent color",     "default": "#E8690A" },
    { "type": "range", "id": "padding_top",    "label": "Padding top",    "min": 0, "max": 120, "step": 4, "default": 64 },
    { "type": "range", "id": "padding_bottom", "label": "Padding bottom", "min": 0, "max": 120, "step": 4, "default": 64 }
  ],
  "presets": [
    { "name": "GK Tour Dates" }
  ]
}
{% endschema %}
