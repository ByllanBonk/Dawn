{% comment %}
  GK Tour Dates (Enhanced Hover Version)
  - Same layout
  - Stronger orange hover glow on date rows
  - Orange highlight + glow on GET TICKETS button hover
{% endcomment %}

{% liquid
  assign today_ymd = 'now' | date: '%Y-%m-%d'
  assign today_midnight_ts = today_ymd | date: '%s' | plus: 0
  assign upcoming_count = 0
%}

<section class="gk-dates" data-section-id="{{ section.id }}">
  <div class="gk-dates__inner">

    {% if section.settings.eyebrow != blank %}
      <div class="gk-dates__eyebrow">{{ section.settings.eyebrow }}</div>
    {% endif %}

    {% if section.settings.heading != blank %}
      <h2 class="gk-dates__heading">{{ section.settings.heading }}</h2>
    {% endif %}

    {% if section.settings.subtext != blank %}
      <div class="gk-dates__subtext">{{ section.settings.subtext }}</div>
    {% endif %}

    <div class="gk-dates__list" role="list"
      data-visible-count="{{ section.settings.visible_count }}"
      data-reveal-step="{{ section.settings.reveal_step }}"
    >
      {% assign render_index = 0 %}

      {% for block in section.blocks %}
        {% liquid
          assign raw_date = block.settings.show_date | strip
          assign show_ts = raw_date | date: '%s' | plus: 0
        %}

        {% if raw_date != blank and show_ts >= today_midnight_ts %}
          {% assign upcoming_count = upcoming_count | plus: 1 %}

          {% assign hidden_class = "" %}
          {% if render_index >= section.settings.visible_count %}
            {% assign hidden_class = " is-hidden" %}
          {% endif %}

          <div class="gk-date{{ hidden_class }}" role="listitem"
               data-date-row data-index="{{ render_index }}"
               {{ block.shopify_attributes }}>

            <div class="gk-date__date">{{ raw_date }}</div>

            <div class="gk-date__details">
              {% if block.settings.venue_name != blank %}
                <div class="gk-date__venue">{{ block.settings.venue_name }}</div>
              {% endif %}
              {% if block.settings.city_state != blank %}
                <div class="gk-date__city">{{ block.settings.city_state }}</div>
              {% endif %}
            </div>

            <div class="gk-date__cta">
              {% if block.settings.is_sold_out %}
                <span class="gk-date__pill gk-date__pill--muted">SOLD OUT</span>
              {% else %}
                {% if block.settings.ticket_url != blank %}
                  <a class="gk-date__pill gk-date__pill--accent"
                     href="{{ block.settings.ticket_url }}"
                     target="_blank" rel="noopener">
                    GET TICKETS
                  </a>
                {% else %}
                  <span class="gk-date__pill gk-date__pill--muted">TBA</span>
                {% endif %}
              {% endif %}
            </div>

          </div>

          {% assign render_index = render_index | plus: 1 %}
        {% endif %}
      {% endfor %}
    </div>

  </div>
</section>

<style>
  .gk-dates{
    --accent: {{ section.settings.accent_color }};
    --accentGlow: rgba(232,105,10,0.35);
    background: {{ section.settings.bg_color }};
    color:#fff;
    padding: {{ section.settings.padding_top }}px 20px {{ section.settings.padding_bottom }}px;
  }

  .gk-dates__inner{ max-width:1100px; margin:0 auto; }

  .gk-dates__heading{
    font-family:"Bebas Neue",sans-serif;
    font-size:clamp(44px,6vw,76px);
    margin:0;
  }

  .gk-dates__subtext{
    margin-top:10px;
    color:rgba(255,255,255,0.7);
  }

  .gk-dates__list{
    margin-top:28px;
    display:flex;
    flex-direction:column;
    gap:14px;
  }

  /* DATE ROW */

  .gk-date{
    position:relative;
    display:grid;
    grid-template-columns:minmax(170px,240px) 1fr auto;
    gap:16px;
    align-items:center;
    padding:20px;
    border-radius:18px;
    border:1px solid rgba(255,255,255,0.12);
    background:linear-gradient(180deg,rgba(255,255,255,0.04),rgba(255,255,255,0.02));
    transition:all 180ms ease;
    overflow:hidden;
  }

  /* Orange hover glow */

  .gk-date::before{
    content:"";
    position:absolute;
    inset:0;
    border-radius:18px;
    pointer-events:none;
    opacity:0;
    transition:opacity 180ms ease;
    background:radial-gradient(
      800px 200px at 20% 50%,
      var(--accentGlow),
      transparent 70%
    );
  }

  .gk-date:hover{
    transform:translateY(-2px);
    border-color:rgba(232,105,10,0.45);
    box-shadow:0 25px 60px rgba(232,105,10,0.15);
  }

  .gk-date:hover::before{
    opacity:1;
  }

  .gk-date__date{
    font-family:"Bebas Neue",sans-serif;
    font-size:34px;
    color:var(--accent);
  }

  .gk-date__venue{ font-size:20px; }
  .gk-date__city{
    font-family:"DM Mono",monospace;
    font-size:13px;
    letter-spacing:0.1em;
    color:rgba(255,255,255,0.7);
  }

  /* BUTTON */

  .gk-date__pill{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    min-height:46px;
    padding:12px 20px;
    border-radius:999px;
    font-family:"DM Mono",monospace;
    font-size:12px;
    letter-spacing:0.12em;
    text-transform:uppercase;
    transition:all 160ms ease;
  }

  .gk-date__pill--accent{
    background:rgba(232,105,10,0.92);
    color:#0D0D0D;
    border:1px solid rgba(232,105,10,0.92);
  }

  /* Orange glow on button hover */

  .gk-date__pill--accent:hover{
    transform:translateY(-2px);
    background:rgba(232,105,10,1);
    border-color:rgba(232,105,10,1);
    box-shadow:0 12px 28px rgba(232,105,10,0.35);
  }

  .gk-date__pill--muted{
    border:1px solid rgba(255,255,255,0.2);
    color:rgba(255,255,255,0.6);
  }

  @media(max-width:820px){
    .gk-date{
      grid-template-columns:1fr;
      gap:12px;
    }
  }
</style>