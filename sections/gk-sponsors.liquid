{%- comment -%}
  GK Sponsors
  - Big logos, no boxes
  - Subtle always-on glow, stronger on hover
  - Slight hover scale
  - Accessible focus states
{%- endcomment -%}

{%- liquid
  assign eyebrow_val = section.settings.eyebrow | strip
  assign heading_val = section.settings.heading | strip
  assign subheading_val = section.settings.subheading | strip
-%}

<section id="GK-Sponsors-{{ section.id }}" class="gk-sponsors">
  <div class="page-width gk-sponsors__inner">

    {%- if eyebrow_val != blank and eyebrow_val != '.' -%}
      <div class="gk-sponsors__eyebrow">{{ eyebrow_val }}</div>
    {%- endif -%}

    {%- if heading_val != blank -%}
      <h2 class="gk-sponsors__heading">{{ heading_val }}</h2>
    {%- endif -%}

    {%- if subheading_val != blank and subheading_val != '.' -%}
      <div class="gk-sponsors__sub">{{ subheading_val }}</div>
    {%- endif -%}

    <div
      class="gk-sponsors__grid"
      style="
        --gk-cols-desktop: {{ section.settings.columns_desktop }};
        --gk-cols-mobile: {{ section.settings.columns_mobile }};
        --gk-gap: {{ section.settings.gap }}px;
        --gk-logo-h: {{ section.settings.logo_height }}px;
        --gk-accent: {{ section.settings.accent }};
        --gk-glow: {{ section.settings.glow_strength }};
        --gk-hover-scale: {{ section.settings.hover_scale | divided_by: 100.0 }};
      "
      aria-label="Sponsors"
    >
      {%- for block in section.blocks -%}
        {%- liquid
          assign logo = block.settings.logo
          assign url = block.settings.url
          assign label = block.settings.label | strip
          assign open_new = block.settings.open_new
          assign nofollow = block.settings.nofollow
        -%}

        {%- if logo != blank -%}
          {%- capture rel_attr -%}
            {%- if open_new -%}noopener{%- endif -%}
            {%- if nofollow -%}{% if open_new %} {% endif %}nofollow{%- endif -%}
          {%- endcapture -%}

          <div class="gk-sponsors__item" {{ block.shopify_attributes }}>
            {%- if url != blank -%}
              <a
                class="gk-sponsors__link"
                href="{{ url }}"
                {%- if open_new -%} target="_blank"{%- endif -%}
                rel="{{ rel_attr | strip }}"
                aria-label="{% if label != blank %}{{ label | escape }}{% else %}Sponsor{% endif %}"
              >
                <img
                  class="gk-sponsors__logo"
                  src="{{ logo | image_url: width: 1200 }}"
                  alt="{% if label != blank %}{{ label | escape }}{% else %}Sponsor{% endif %}"
                  loading="lazy"
                  width="{{ logo.width }}"
                  height="{{ logo.height }}"
                >
              </a>
            {%- else -%}
              <div class="gk-sponsors__link" role="img" aria-label="{% if label != blank %}{{ label | escape }}{% else %}Sponsor{% endif %}">
                <img
                  class="gk-sponsors__logo"
                  src="{{ logo | image_url: width: 1200 }}"
                  alt="{% if label != blank %}{{ label | escape }}{% else %}Sponsor{% endif %}"
                  loading="lazy"
                  width="{{ logo.width }}"
                  height="{{ logo.height }}"
                >
              </div>
            {%- endif -%}
          </div>
        {%- endif -%}
      {%- endfor -%}
    </div>
  </div>

  <style>
    /* ============================
      GK Sponsors (scoped)
      ============================ */
    #GK-Sponsors-{{ section.id }}.gk-sponsors{
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }

    #GK-Sponsors-{{ section.id }} .gk-sponsors__inner{
      max-width: 1200px;
      margin: 0 auto;
      text-align: center;
    }

    #GK-Sponsors-{{ section.id }} .gk-sponsors__eyebrow{
      font-size: 12px;
      letter-spacing: .14em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.66);
      margin-bottom: 10px;
    }

    #GK-Sponsors-{{ section.id }} .gk-sponsors__heading{
      margin: 0;
      font-weight: 800;
      letter-spacing: 0.02em;
      line-height: 1.05;
      font-size: clamp(26px, 4vw, 44px);
      color: rgba(255,255,255,0.92);
    }

    #GK-Sponsors-{{ section.id }} .gk-sponsors__sub{
      margin-top: 10px;
      margin-bottom: 18px;
      color: rgba(255,255,255,0.66);
      font-size: 15px;
    }

    #GK-Sponsors-{{ section.id }} .gk-sponsors__grid{
      display: grid;
      grid-template-columns: repeat(var(--gk-cols-mobile), minmax(0, 1fr));
      gap: var(--gk-gap);
      align-items: center;
      justify-items: center;

      /* keeps it feeling like the old strip */
      padding-top: 10px;
    }

    @media (min-width: 750px){
      #GK-Sponsors-{{ section.id }} .gk-sponsors__grid{
        grid-template-columns: repeat(var(--gk-cols-desktop), minmax(0, 1fr));
      }
    }

    #GK-Sponsors-{{ section.id }} .gk-sponsors__item{
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* NO BOXES: this is just a hit area */
    #GK-Sponsors-{{ section.id }} .gk-sponsors__link{
      display: inline-flex;
      align-items: center;
      justify-content: center;

      /* big click target, but invisible */
      width: 100%;
      padding: 10px 6px;

      text-decoration: none;
      border: 0;
      background: transparent;
      border-radius: 14px;
      outline: none;
      -webkit-tap-highlight-color: transparent;
    }

    /* BIG LOGOS */
    #GK-Sponsors-{{ section.id }} .gk-sponsors__logo{
      height: var(--gk-logo-h);
      width: auto;
      max-width: min(100%, 320px);
      object-fit: contain;
      display: block;

      opacity: 0.92;

      /* Always-on glow */
      filter:
        drop-shadow(0 0 calc(10px * var(--gk-glow)) rgba(232,105,10,0.18))
        drop-shadow(0 0 calc(22px * var(--gk-glow)) rgba(232,105,10,0.10));

      transform: translateZ(0);
      transition: transform 160ms ease, filter 160ms ease, opacity 160ms ease;
    }

    /* Hover: slightly bigger + stronger glow */
    @media (hover:hover){
      #GK-Sponsors-{{ section.id }} .gk-sponsors__link:hover .gk-sponsors__logo{
        opacity: 1;
        transform: scale(var(--gk-hover-scale));
        filter:
          drop-shadow(0 0 calc(14px * var(--gk-glow)) rgba(232,105,10,0.34))
          drop-shadow(0 0 calc(36px * var(--gk-glow)) rgba(232,105,10,0.18));
      }
    }

    /* Keyboard focus: nice orange ring, still no “box” look */
    #GK-Sponsors-{{ section.id }} .gk-sponsors__link:focus-visible{
      box-shadow:
        0 0 0 1px rgba(232,105,10,0.45),
        0 0 26px rgba(232,105,10,0.18);
    }

    @media (prefers-reduced-motion: reduce){
      #GK-Sponsors-{{ section.id }} .gk-sponsors__logo{
        transition: none !important;
      }
    }
  </style>
</section>

{% schema %}
{
  "name": "GK Sponsors",
  "tag": "section",
  "class": "section",
  "settings": [
    { "type": "text", "id": "eyebrow", "label": "Eyebrow (optional)", "default": "." },
    { "type": "text", "id": "heading", "label": "Heading", "default": "Sponsors" },
    { "type": "text", "id": "subheading", "label": "Subheading (optional)", "default": "." },

    { "type": "range", "id": "columns_desktop", "min": 3, "max": 8, "step": 1, "unit": "col", "label": "Columns (desktop)", "default": 6 },
    { "type": "range", "id": "columns_mobile", "min": 2, "max": 4, "step": 1, "unit": "col", "label": "Columns (mobile)", "default": 2 },

    { "type": "range", "id": "gap", "min": 10, "max": 40, "step": 2, "unit": "px", "label": "Gap", "default": 18 },

    { "type": "range", "id": "logo_height", "min": 48, "max": 120, "step": 2, "unit": "px", "label": "Logo height", "default": 86 },

    { "type": "range", "id": "hover_scale", "min": 102, "max": 130, "step": 1, "unit": "%", "label": "Hover scale", "default": 112 },

    { "type": "range", "id": "glow_strength", "min": 1, "max": 3, "step": 1, "label": "Glow strength", "default": 2 },

    { "type": "color", "id": "accent", "label": "Accent color", "default": "#E8690A" },

    { "type": "range", "id": "padding_top", "min": 0, "max": 140, "step": 4, "unit": "px", "label": "Padding top", "default": 40 },
    { "type": "range", "id": "padding_bottom", "min": 0, "max": 140, "step": 4, "unit": "px", "label": "Padding bottom", "default": 40 }
  ],
  "blocks": [
    {
      "type": "sponsor",
      "name": "Sponsor",
      "settings": [
        { "type": "image_picker", "id": "logo", "label": "Logo" },
        { "type": "text", "id": "label", "label": "Label (optional)", "default": "." },
        { "type": "url", "id": "url", "label": "Sponsor URL" },
        { "type": "checkbox", "id": "open_new", "label": "Open in new tab", "default": true },
        { "type": "checkbox", "id": "nofollow", "label": "Add nofollow", "default": false }
      ]
    }
  ],
  "presets": [
    {
      "name": "GK Sponsors",
      "blocks": [
        { "type": "sponsor" },
        { "type": "sponsor" },
        { "type": "sponsor" },
        { "type": "sponsor" },
        { "type": "sponsor" },
        { "type": "sponsor" }
      ]
    }
  ]
}
{% endschema %}